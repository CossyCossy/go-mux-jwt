test:
  override:
    - go test -cover -coverprofile=coverage.out
    - go tool cover -html=coverage.out -o coverage.html
  post:
    - npm install -g codeclimate-test-reporter
    - go get github.com/axw/gocov/gocov
    #- CODECLIMATE_REPO_TOKEN=$CodeClimateToken codeclimate-test-reporter < coverage.out
    - CODECLIMATE_REPO_TOKEN=$CodeClimateToken codeclimate-test-reporter < gocov convert coverage.out | gocov annotate -
    - go get -u github.com/jstemmer/go-junit-report
    - go test -v 2>&1 | go-junit-report > JUnitReport.xml
    - mkdir $CIRCLE_TEST_REPORTS/junitformat
    - mv JUnitReport.xml $CIRCLE_TEST_REPORTS/junitformat
    - mkdir $CIRCLE_ARTIFACTS/coverage
    - mv coverage.html $CIRCLE_ARTIFACTS/coverage